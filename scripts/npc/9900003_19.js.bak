var a = 0;
var text;
var selects; //记录玩家的选项
var buynum = 0;
var itemlist = Array(
					Array(2610001, 50000),//漩涡解封卷
					Array(4001839, 200),//星星
					Array(2049402, 3000), // - 特殊潜能附加卷轴
					Array(2048307, 5000), // - 特殊附加潜能附加卷轴
					Array(2049016, 30000), // - 白医卷轴 20% 
					Array(2040006, 30000), // - 头盔防御必成卷
					Array(2040303, 30000), // - 耳环智力必成卷
					Array(2040403, 30000), // - 上衣防御必成卷
					Array(2040506, 30000), // - 全身盔甲敏捷必成卷
					Array(2040507, 30000), // - 全身盔甲防御必成卷
					Array(2040603, 30000), // - 裤裙防御必成卷
					Array(2040709, 30000), // - 鞋子敏捷必成卷
					Array(2040710, 30000), // - 鞋子跳跃必成卷
					Array(2040711, 30000), // - 鞋子速度必成卷
					Array(2040806, 30000), // - 手套敏捷必成卷
					Array(2040807, 30000), // - 手套攻击诅咒卷轴
					Array(2041024, 30000), // - 披风魔法防御必成卷 
					Array(2041025, 30000), // - 披风物理防御必成卷 
					Array(2043003, 30000), // - 单手剑攻击必成卷
					Array(2043203, 30000), // - 单手钝器攻击必成卷
					Array(2043303, 30000), // - 短剑攻击必成卷
					Array(2043703, 30000), // - 短杖攻击必成卷
					Array(2043803, 30000), // - 长杖攻击必成卷
					Array(2044003, 30000), // - 双手剑攻击必成卷
					Array(2044303, 30000), // - 枪攻击必成卷
					Array(2044403, 30000), // - 矛攻击必成卷
					Array(2044503, 30000), // - 弓攻击必成卷
					Array(2044603, 30000), // - 弩攻击必成卷
					Array(2044703, 30000), // - 拳套攻击必成卷
					Array(2044815, 30000), // - 指节攻击必成卷
					Array(2044908, 30000), // - 短枪攻击必成卷
					Array(2043404, 50000), // - 刀攻击卷
					Array(2045206, 50000), // - 双弩枪攻击力卷轴
					Array(2045306, 50000), // - 手炮攻击力卷轴
					Array(2043606, 50000), //  - 手杖攻击力卷轴
					Array(2340000, 100000), // - 祝福卷轴
					Array(2049116, 100000), // - 强化混沌卷轴
					Array(2046008, 100000), // - 周年庆单手武器攻击力卷轴50%
					Array(2046009, 100000), // - 周年庆单手武器魔法力卷轴50%
					Array(2046108, 100000), // - 周年庆双手武器攻击力卷轴50%
					Array(2046109, 100000), // - 周年庆双手武器魔法力卷轴50%
					Array(2046913, 300000), //  - 宿命正义单手武器攻击力卷轴 100% 
					Array(2046914, 300000), // - 宿命正义单手武器魔力卷轴 100% 
					Array(2046173, 300000), // - 宿命正义双手武器攻击力卷轴 100%
					Array(2046577, 300000), //  - 宿命正义防具力量卷轴 100%
					Array(2046578, 300000), // - 宿命正义防具智力卷轴 100%
					Array(2046579, 300000), // - 宿命正义防具敏捷卷轴 100% 
					Array(2046580, 300000), // - 宿命正义防具运气卷轴 100%
					Array(2046763, 400000), // - 宿命正义饰品力量卷轴 100%
					Array(2046764, 400000), // - 宿命正义饰品智力卷轴 100%
					Array(2046765, 400000), // - 宿命正义饰品敏捷卷轴 100%
					Array(2046766, 400000)  // - 宿命正义饰品运气卷轴 100%
					);

function start() {
    a = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) {
        cm.dispose();
    } else {
        if (mode == 1)
            a++;
        else
            a--;
        if (a == -1) {
            cm.dispose();
        } else if (a == 0) {
			text = "#h0#,你好！在这里可以选择你想要购买的物品:\r\n\r\n#b";
			for (var i=0; i<itemlist.length; i++) {
				text += "#L" + i + "##i" + itemlist[i] + "# #z" + itemlist[i] + "#\r\n";
				if (i != 0 && (i+1) % 5 == 0) {
					text += "";
				}
			}
            cm.sendSimple(text);
        } else if (a == 1) {
			selects = selection;
            cm.sendGetNumber("请输入你请你输入想要购买的数量\r\n\r\n#r - 1个需要" + itemlist[selects][1] + "抵用卷", 0, 0, 999999);
        } else if (a == 2) {
            buynum = selection;
            cm.sendNext("你想购买" + buynum + "个#r#i" + itemlist[selects][0] + "##k？\r\n你将使用掉" + (buynum * itemlist[selects][1]) + "抵用卷。");
        } else if (a == 3) {
            if (cm.getChar().getCSPoints(2) >= buynum * itemlist[selects][1]) {
                cm.getChar().modifyCSPoints(2, -buynum * itemlist[selects][1]);
                cm.gainItem(itemlist[selects][0], buynum);
                cm.sendOk("购买成功了！");
                cm.dispose();
            } else {
                cm.sendOk("对不起，你没有足够的抵用卷，请打怪或者使用点卷换取后获得。");
                cm.dispose();
            }
        }
    }//mode
}//f